#include "canvas_widget.h"

#include <GL/gl.h>
#include <QWheelEvent>

#include <QDebug>

#include "painter.h"
#include "point.h"

const double CanvasWidget::m_max_width = 720;
const double CanvasWidget::m_max_height = 360;

Point ceara[] = {Point(-40.516666666667,-2.7833333333333),
Point(-40.216666666667003,-2.8166666666667),
Point(-40.116666666667001,-2.8833333333333),
Point(-40.833333333333002,-2.9166666666667),
Point(-39.916666666666998,-2.9166666666667),
Point(-40.483333333333,-2.9166666666667),
Point(-40.183333333333003,-2.9333333333333),
Point(-40.266666666667,-2.9333333333333),
Point(-40.933333333333003,-2.9666666666667),
Point(-40.566666666666997,-3.0),
Point(-39.688055555555998,-3.0063888888889),
Point(-41.116666666667001,-3.0166666666667),
Point(-40.05,-3.0166666666667),
Point(-41.233333333333,-3.0333333333333),
Point(-40.65,-3.0333333333333),
Point(-39.666666666666998,-3.0333333333333),
Point(-40.168333333333003,-3.0575),
Point(-39.583333333333002,-3.1),
Point(-40.833333333333002,-3.1333333333333),
Point(-40.9,-3.1333333333333),
Point(-40.15,-3.15),
Point(-39.433333333333003,-3.15),
Point(-39.163611111111003,-3.1641666666667),
Point(-40.466666666667003,-3.1666666666667),
Point(-39.75,-3.1833333333333),
Point(-39.983333333333,-3.2),
Point(-40.415833333332998,-3.2219444444444),
Point(-40.683333333333003,-3.2333333333333),
Point(-40.116666666667001,-3.2333333333333),
Point(-39.633333333332999,-3.2333333333333),
Point(-40.8,-3.2333333333333),
Point(-41.133333333332999,-3.25),
Point(-41.233333333333,-3.25),
Point(-39.266666666667,-3.2666666666667),
Point(-39.25,-3.2833333333333),
Point(-40.566666666666997,-3.3166666666667),
Point(-39.4,-3.3166666666667),
Point(-40.466666666667003,-3.35),
Point(-40.983333333333,-3.35),
Point(-41.266666666667,-3.35),
Point(-39.830555555556003,-3.3638888888889),
Point(-40.733333333333,-3.3666666666667),
Point(-39.166666666666998,-3.4),
Point(-39.033333333332997,-3.4166666666667),
Point(-40.533333333332997,-3.4166666666667),
Point(-40.383333333332999,-3.4166666666667),
Point(-40.683333333333003,-3.4666666666667),
Point(-40.2,-3.4666666666667),
Point(-40.828333333332999,-3.4747222222222),
Point(-39.566666666666997,-3.5),
Point(-41.116666666667001,-3.5),
Point(-41.016666666667,-3.5),
Point(-38.946388888888997,-3.5330555555556),
Point(-40.333333333333002,-3.5333333333333),
Point(-40.566666666666997,-3.5333333333333),
Point(-39.583333333333002,-3.5333333333333),
Point(-39.582777777777999,-3.5436111111111),
Point(-40.45,-3.55),
Point(-38.833333333333002,-3.55),
Point(-39.185555555556,-3.5563888888889),
Point(-39.185555555556,-3.5563888888889),
Point(-41.094166666667,-3.5641666666667),
Point(-40.65,-3.5666666666667),
Point(-39.966666666667003,-3.5666666666667),
Point(-41.341666666667003,-3.5733333333333),
Point(-40.55,-3.5833333333333),
Point(-38.966666666667003,-3.5833333333333),
Point(-39.45,-3.6),
Point(-40.266666666667,-3.6),
Point(-38.969722222222003,-3.6105555555556),
Point(-39.5,-3.6166666666667),
Point(-39.816666666666997,-3.6166666666667),
Point(-40.483333333333,-3.6166666666667),
Point(-41.15,-3.6333333333333),
Point(-38.783333333332997,-3.6333333333333),
Point(-40.616666666667001,-3.6333333333333),
Point(-40.45,-3.65),
Point(-39.266666666667,-3.6666666666667),
Point(-39.35,-3.6666666666667),
Point(-40.366666666667001,-3.6666666666667),
Point(-40.233333333333,-3.6666666666667),
Point(-39.516666666667,-3.6666666666667),
Point(-39.583333333333002,-3.6833333333333),
Point(-40.516666666667,-3.6833333333333),
Point(-40.35,-3.7),
Point(-40.35,-3.7),
Point(-40.333333333333002,-3.7166666666667),
Point(-40.016666666667,-3.7166666666667),
Point(-41.166666666666998,-3.7166666666667),
Point(-38.566666666666997,-3.7333333333333),
Point(-39.75,-3.7333333333333),
Point(-40.983333333333,-3.7333333333333),
Point(-40.383333333332999,-3.7333333333333),
Point(-40.683333333333003,-3.7333333333333),
Point(-38.683333333333003,-3.75),
Point(-39.666666666666998,-3.75),
Point(-38.916666666666998,-3.75),
Point(-39.066666666666997,-3.75),
Point(-38.583333333333002,-3.75),
Point(-39.366666666667001,-3.75),
Point(-40.566666666666997,-3.75),
Point(-40.383333333332999,-3.75),
Point(-40.35,-3.75),
Point(-40.816666666666997,-3.7666666666667),
Point(-39.266666666667,-3.7833333333333),
Point(-38.466666666667003,-3.7833333333333),
Point(-39.25,-3.7833333333333),
Point(-40.65,-3.7833333333333),
Point(-40.25,-3.8),
Point(-40.233333333333,-3.8),
Point(-38.95,-3.8166666666667),
Point(-38.533333333332997,-3.8166666666667),
Point(-38.466666666667003,-3.8333333333333),
Point(-40.666666666666998,-3.8333333333333),
Point(-40.5,-3.8333333333333),
Point(-41.063055555555998,-3.8483333333333),
Point(-40.916666666666998,-3.85),
Point(-38.1175,-3.8583333333333),
Point(-38.623333333333001,-3.8616666666667),
Point(-38.75,-3.8666666666667),
Point(-40.016666666667,-3.8833333333333),
Point(-39.866666666667001,-3.8833333333333),
Point(-38.383333333332999,-3.9),
Point(-38.633333333332999,-3.9),
Point(-38.666666666666998,-3.9),
Point(-40.766666666667,-3.9),
Point(-40.266666666667,-3.9),
Point(-39.0,-3.9),
Point(-38.5,-3.9),
Point(-40.383333333332999,-3.9166666666667),
Point(-40.883333333332999,-3.9166666666667),
Point(-39.7,-3.9166666666667),
Point(-38.6,-3.9166666666667),
Point(-38.393333333332997,-3.9288888888889),
Point(-39.433333333333003,-3.95),
Point(-40.466666666667003,-3.95),
Point(-38.516666666667,-3.95),
Point(-39.55,-3.95),
Point(-38.883333333332999,-3.95),
Point(-39.533333333332997,-3.9666666666667),
Point(-39.133333333332999,-3.9666666666667),
Point(-38.716666666667003,-3.9666666666667),
Point(-38.75,-3.9666666666667),
Point(-40.354722222222001,-3.9691666666667),
Point(-38.616666666667001,-3.9833333333333),
Point(-40.7,-3.9833333333333),
Point(-39.583333333333002,-3.9833333333333),
Point(-39.433333333333003,-4.0166666666667),
Point(-38.933333333333003,-4.0166666666667),
Point(-38.95,-4.0166666666667),
Point(-38.883333333332999,-4.0166666666667),
Point(-38.633333333332999,-4.0333333333333),
Point(-38.716666666667003,-4.0333333333333),
Point(-39.45,-4.05),
Point(-40.866666666667001,-4.05),
Point(-38.333333333333002,-4.05),
Point(-40.516666666667,-4.05),
Point(-40.75,-4.05),
Point(-40.45,-4.05),
Point(-40.95,-4.05),
Point(-39.466666666667003,-4.0666666666667),
Point(-39.466666666667003,-4.0666666666667),
Point(-39.25,-4.0833333333333),
Point(-39.05,-4.0833333333333),
Point(-38.783333333332997,-4.0833333333333),
Point(-39.95,-4.0833333333333),
Point(-38.483333333333,-4.1),
Point(-38.233333333333,-4.1333333333333),
Point(-38.833333333333002,-4.15),
Point(-40.583333333333002,-4.15),
Point(-38.316666666666997,-4.15),
Point(-38.725833333333,-4.1538888888889),
Point(-40.95,-4.1666666666667),
Point(-38.583333333333002,-4.1666666666667),
Point(-40.866666666667001,-4.1666666666667),
Point(-40.75,-4.1833333333333),
Point(-38.466666666667003,-4.1833333333333),
Point(-40.483333333333,-4.1833333333333),
Point(-40.316666666666997,-4.1833333333333),
Point(-38.816666666666997,-4.2),
Point(-39.716666666667003,-4.2),
Point(-40.733333333333,-4.2),
Point(-40.766666666667,-4.2),
Point(-38.116666666667001,-4.2166666666667),
Point(-38.916666666666998,-4.2166666666667),
Point(-38.7,-4.2166666666667),
Point(-40.066666666666997,-4.2166666666667),
Point(-39.183333333333003,-4.2333333333333),
Point(-39.266666666667,-4.2333333333333),
Point(-40.65,-4.25),
Point(-38.933333333333003,-4.2666666666667),
Point(-38.033333333332997,-4.2666666666667),
Point(-38.516666666667,-4.2833333333333),
Point(-38.633333333332999,-4.2833333333333),
Point(-38.616666666667001,-4.2833333333333),
Point(-38.983333333333,-4.3),
Point(-38.5,-4.3),
Point(-40.7,-4.3166666666667),
Point(-39.816666666666997,-4.3166666666667),
Point(-38.866666666667001,-4.3333333333333),
Point(-40.15,-4.3333333333333),
Point(-40.583333333333002,-4.3333333333333),
Point(-40.55,-4.3333333333333),
Point(-38.8,-4.3666666666667),
Point(-39.316666666666997,-4.3666666666667),
Point(-41.05,-4.3666666666667),
Point(-37.924444444443999,-4.3727777777778),
Point(-39.350833333333,-4.4008333333333),
Point(-39.05,-4.4166666666667),
Point(-40.4,-4.4166666666667),
Point(-40.883333333332999,-4.4166666666667),
Point(-39.616666666667001,-4.4166666666667),
Point(-40.916666666666998,-4.4166666666667),
Point(-40.783333333332997,-4.4333333333333),
Point(-37.783333333332997,-4.45),
Point(-38.5,-4.45),
Point(-38.9,-4.4666666666667),
Point(-38.55,-4.4666666666667),
Point(-38.35,-4.4833333333333),
Point(-38.6,-4.4833333333333),
Point(-40.166666666666998,-4.5),
Point(-38.616666666667001,-4.5166666666667),
Point(-38.183333333333003,-4.5166666666667),
Point(-40.3,-4.5166666666667),
Point(-39.379722222222,-4.5269444444444),
Point(-40.716666666667003,-4.5333333333333),
Point(-39.616666666667001,-4.5333333333333),
Point(-38.55,-4.5333333333333),
Point(-39.0,-4.55),
Point(-37.783333333332997,-4.55),
Point(-40.966666666667003,-4.55),
Point(-37.766666666667,-4.5666666666667),
Point(-38.35,-4.5666666666667),
Point(-40.816666666666997,-4.5666666666667),
Point(-39.783333333332997,-4.5666666666667),
Point(-38.95,-4.5833333333333),
Point(-38.216666666667003,-4.5833333333333),
Point(-38.033333333332997,-4.5833333333333),
Point(-39.5,-4.6),
Point(-39.466666666667003,-4.6),
Point(-37.866666666667001,-4.6),
Point(-40.616666666667001,-4.6275),
Point(-40.383333333332999,-4.6333333333333),
Point(-39.233333333333,-4.6333333333333),
Point(-40.066666666666997,-4.6333333333333),
Point(-38.55,-4.65),
Point(-39.666666666666998,-4.65),
Point(-37.833333333333002,-4.65),
Point(-40.2,-4.6666666666667),
Point(-39.25,-4.6666666666667),
Point(-37.816666666666997,-4.6833333333333),
Point(-38.683333333333003,-4.6833333333333),
Point(-39.433333333333003,-4.6833333333333),
Point(-38.2,-4.6833333333333),
Point(-38.4,-4.6833333333333),
Point(-37.366666666667001,-4.7),
Point(-39.316666666666997,-4.7),
Point(-37.516666666667,-4.7),
Point(-40.566666666666997,-4.7166666666667),
Point(-40.916666666666998,-4.7333333333333),
Point(-40.833333333333002,-4.7333333333333),
Point(-37.966666666667003,-4.75),
Point(-39.933333333333003,-4.75),
Point(-38.5,-4.7666666666667),
Point(-37.766666666667,-4.7666666666667),
Point(-39.916666666666998,-4.7666666666667),
Point(-37.266666666667,-4.7833333333333),
Point(-40.066666666666997,-4.8),
Point(-37.4,-4.8),
Point(-39.614166666667003,-4.8011111111111),
Point(-39.783333333332997,-4.8166666666667),
Point(-37.266666666667,-4.8166666666667),
Point(-38.816666666666997,-4.8166666666667),
Point(-37.783333333332997,-4.8333333333333),
Point(-40.333333333333002,-4.8333333333333),
Point(-39.15,-4.8333333333333),
Point(-38.233333333333,-4.8333333333333),
Point(-38.166666666666998,-4.8333333333333),
Point(-39.566666666666997,-4.85),
Point(-39.266666666667,-4.85),
Point(-38.216666666667003,-4.8666666666667),
Point(-39.9,-4.8666666666667),
Point(-38.85,-4.8666666666667),
Point(-40.75,-4.8833333333333),
Point(-37.866666666667001,-4.8833333333333),
Point(-39.8,-4.9),
Point(-38.083333333333002,-4.9166666666667),
Point(-39.383333333332999,-4.9166666666667),
Point(-40.133333333332999,-4.9166666666667),
Point(-37.966666666667003,-4.9333333333333),
Point(-40.533333333332997,-4.9333333333333),
Point(-38.250277777778003,-4.965),
Point(-39.033333333332997,-4.9666666666667),
Point(-38.633333333332999,-4.9666666666667),
Point(-39.966666666667003,-4.9666666666667),
Point(-38.335277777778003,-4.9808333333333),
Point(-38.216666666667003,-4.9833333333333),
Point(-39.066666666666997,-4.9833333333333),
Point(-39.166666666666998,-4.9833333333333),
Point(-40.2,-4.9833333333333),
Point(-39.482222222221999,-4.9933333333333),
Point(-38.716666666667003,-5.0),
Point(-39.733333333333,-5.0),
Point(-40.933333333333003,-5.05),
Point(-40.566666666666997,-5.05),
Point(-40.580555555556003,-5.0586111111111),
Point(-37.983333333333,-5.0666666666667),
Point(-37.9,-5.0666666666667),
Point(-40.816666666666997,-5.0666666666667),
Point(-38.9,-5.0666666666667),
Point(-40.3,-5.0833333333333),
Point(-38.366666666667001,-5.1),
Point(-39.6,-5.1),
Point(-40.048888888889003,-5.1061111111111),
Point(-39.716666666667003,-5.1333333333333),
Point(-38.1,-5.1333333333333),
Point(-39.166666666666998,-5.1333333333333),
Point(-38.466666666667003,-5.1333333333333),
Point(-40.416666666666998,-5.15),
Point(-38.883333333332999,-5.15),
Point(-39.466666666667003,-5.15),
Point(-38.65,-5.15),
Point(-38.083333333333002,-5.1833333333333),
Point(-40.666666666666998,-5.2),
Point(-39.283333333332997,-5.2),
Point(-39.316666666666997,-5.2),
Point(-40.177777777777997,-5.2016666666667),
Point(-40.703611111111002,-5.2108333333333),
Point(-39.566666666666997,-5.2166666666667),
Point(-38.483333333333,-5.2333333333333),
Point(-40.916666666666998,-5.2333333333333),
Point(-38.133333333332999,-5.25),
Point(-38.35,-5.2666666666667),
Point(-39.683333333333003,-5.2666666666667),
Point(-40.7,-5.2666666666667),
Point(-38.266666666667,-5.2833333333333),
Point(-39.133333333332999,-5.2833333333333),
Point(-38.75,-5.2897222222222),
Point(-40.263888888888999,-5.3005555555556),
Point(-38.916666666666998,-5.3166666666667),
Point(-39.5,-5.3333333333333),
Point(-39.316666666666997,-5.3627777777778),
Point(-38.243888888889003,-5.3886111111111),
Point(-40.312777777778003,-5.3936111111111),
Point(-39.016666666667,-5.4),
Point(-40.633333333332999,-5.4),
Point(-40.483333333333,-5.4166666666667),
Point(-39.35,-5.4166666666667),
Point(-38.766666666667,-5.4166666666667),
Point(-40.85,-5.4333333333333),
Point(-40.0,-5.4333333333333),
Point(-38.4,-5.4333333333333),
Point(-39.716666666667003,-5.45),
Point(-39.733333333333,-5.45),
Point(-38.116666666667001,-5.45),
Point(-40.483333333333,-5.45),
Point(-38.4,-5.4666666666667),
Point(-38.883333333332999,-5.4833333333333),
Point(-40.432777777778,-5.4844444444444),
Point(-40.211666666667,-5.485),
Point(-39.3,-5.5),
Point(-40.858055555556,-5.5155555555556),
Point(-38.25,-5.5166666666667),
Point(-39.483333333333,-5.5166666666667),
Point(-40.773888888888997,-5.5386111111111),
Point(-40.066666666666997,-5.55),
Point(-39.163333333333,-5.5591666666667),
Point(-39.633333333332999,-5.5666666666667),
Point(-40.333333333333002,-5.5666666666667),
Point(-38.311944444444002,-5.5677777777778),
Point(-39.366666666667001,-5.5833333333333),
Point(-38.766666666667,-5.6166666666667),
Point(-40.295,-5.6208333333333),
Point(-38.616666666667001,-5.65),
Point(-38.9,-5.65),
Point(-39.844166666667,-5.6511111111111),
Point(-38.116666666667001,-5.6666666666667),
Point(-39.95,-5.6666666666667),
Point(-40.349444444444003,-5.6738888888889),
Point(-40.491388888888999,-5.6802777777778),
Point(-39.2,-5.6833333333333),
Point(-38.283333333332997,-5.6833333333333),
Point(-38.966666666667003,-5.6833333333333),
Point(-40.348611111110998,-5.6933333333333),
Point(-39.016666666667,-5.7),
Point(-38.166666666666998,-5.7),
Point(-40.7,-5.7166666666667),
Point(-38.151388888889002,-5.7227777777778),
Point(-39.616666666667001,-5.75),
Point(-40.116666666667001,-5.75),
Point(-40.166666666666998,-5.7666666666667),
Point(-38.333333333333002,-5.7833333333333),
Point(-38.216666666667003,-5.7833333333333),
Point(-40.616666666667001,-5.7833333333333),
Point(-39.25,-5.8),
Point(-38.3,-5.8166666666667),
Point(-39.416666666666998,-5.8166666666667),
Point(-39.984166666667001,-5.8194444444444),
Point(-40.45,-5.85),
Point(-40.216666666667003,-5.85),
Point(-38.320833333332999,-5.8658333333333),
Point(-40.583333333333002,-5.8666666666667),
Point(-38.383333333332999,-5.8666666666667),
Point(-39.95,-5.8833333333333),
Point(-39.154722222221999,-5.8847222222222),
Point(-38.411388888889,-5.8897222222222),
Point(-38.616666666667001,-5.9),
Point(-40.7,-5.9),
Point(-39.416666666666998,-5.9166666666667),
Point(-39.266666666667,-5.9166666666667),
Point(-40.35,-5.9166666666667),
Point(-38.216666666667003,-5.9166666666667),
Point(-38.9,-5.9333333333333),
Point(-39.525555555555997,-5.9425),
Point(-38.274444444444001,-5.9638888888889),
Point(-39.9,-5.9666666666667),
Point(-40.116666666667001,-5.9666666666667),
Point(-40.466666666667003,-5.9666666666667),
Point(-38.5,-6.0),
Point(-40.283333333332997,-6.0166666666667),
Point(-38.4,-6.0166666666667),
Point(-38.466666666667003,-6.05),
Point(-40.75,-6.05),
Point(-38.35,-6.05),
Point(-38.616666666667001,-6.05),
Point(-39.566666666666997,-6.05),
Point(-40.6,-6.0666666666667),
Point(-38.866666666667001,-6.0666666666667),
Point(-40.8,-6.0666666666667),
Point(-39.733333333333,-6.0833333333333),
Point(-39.45,-6.1166666666667),
Point(-39.866666666667001,-6.1333333333333),
Point(-40.4,-6.15),
Point(-39.416666666666998,-6.1833333333333),
Point(-40.15,-6.1833333333333),
Point(-39.566666666666997,-6.1833333333333),
Point(-38.540555555555997,-6.1836111111111),
Point(-38.533333333332997,-6.2),
Point(-39.316666666666997,-6.2),
Point(-40.7,-6.2166666666667),
Point(-38.666666666666998,-6.2166666666667),
Point(-39.183333333333003,-6.2333333333333),
Point(-40.35,-6.2333333333333),
Point(-38.916666666666998,-6.25),
Point(-39.266666666667,-6.25),
Point(-39.75,-6.25),
Point(-38.916666666666998,-6.2666666666667),
Point(-39.6,-6.2833333333333),
Point(-40.15,-6.3166666666667),
Point(-39.033333333332997,-6.3166666666667),
Point(-38.733333333333,-6.3333333333333),
Point(-39.666666666666998,-6.35),
Point(-39.3,-6.3666666666667),
Point(-39.3,-6.3833333333333),
Point(-38.85,-6.4),
Point(-38.95,-6.4),
Point(-39.4,-6.4),
Point(-39.033333333332997,-6.4),
Point(-39.193611111110997,-6.4244444444444),
Point(-39.333333333333002,-6.4333333333333),
Point(-40.716666666667003,-6.4333333333333),
Point(-39.4,-6.45),
Point(-39.116666666667001,-6.4666666666667),
Point(-39.066666666666997,-6.4666666666667),
Point(-39.683333333333003,-6.4666666666667),
Point(-38.633333333332999,-6.4833333333333),
Point(-40.366666666667001,-6.5),
Point(-39.516666666667,-6.5166666666667),
Point(-39.5,-6.5333333333333),
Point(-39.9,-6.5333333333333),
Point(-39.930833333332998,-6.535),
Point(-40.116666666667001,-6.5666666666667),
Point(-39.066666666666997,-6.6),
Point(-40.316666666666997,-6.6),
Point(-40.316666666666997,-6.6),
Point(-39.633333333332999,-6.6),
Point(-38.643055555556003,-6.605),
Point(-38.678055555556,-6.6325),
Point(-38.7,-6.6333333333333),
Point(-39.316666666666997,-6.6333333333333),
Point(-39.5,-6.65),
Point(-40.516666666667,-6.65),
Point(-38.883333333332999,-6.6666666666667),
Point(-39.016666666667,-6.6666666666667),
Point(-39.75,-6.6833333333333),
Point(-38.716666666667003,-6.7333333333333),
Point(-38.966666666667003,-6.75),
Point(-39.116666666667001,-6.75),
Point(-40.266666666667,-6.75),
Point(-40.05,-6.7666666666667),
Point(-39.346111111111,-6.7825),
Point(-39.983333333333,-6.7833333333333),
Point(-38.716666666667003,-6.7833333333333),
Point(-38.8,-6.7833333333333),
Point(-39.3,-6.8),
Point(-38.966666666667003,-6.8166666666667),
Point(-39.516666666667,-6.8166666666667),
Point(-38.733333333333,-6.85),
Point(-39.866666666667001,-6.8666666666667),
Point(-39.383333333332999,-6.8666666666667),
Point(-40.366666666667001,-6.8666666666667),
Point(-39.216666666667003,-6.8833333333333),
Point(-39.1,-6.8833333333333),
Point(-40.166666666666998,-6.9),
Point(-39.566666666666997,-6.9166666666667),
Point(-38.966666666667003,-6.95),
Point(-39.166666666666998,-6.95),
Point(-38.831111111110999,-6.9655555555556),
Point(-40.333333333333002,-6.9666666666667),
Point(-39.733333333333,-7.0),
Point(-38.75,-7.0),
Point(-39.283333333332997,-7.0333333333333),
Point(-40.116666666667001,-7.0333333333333),
Point(-39.466666666667003,-7.0333333333333),
Point(-38.7,-7.05),
Point(-39.866666666667001,-7.05),
Point(-40.366666666667001,-7.0666666666667),
Point(-40.317777777777998,-7.0811111111111),
Point(-38.716666666667003,-7.0833333333333),
Point(-39.683333333333003,-7.1),
Point(-40.016666666667,-7.1),
Point(-39.0,-7.1),
Point(-39.416666666666998,-7.1166666666667),
Point(-39.333333333333002,-7.1333333333333),
Point(-38.766666666667,-7.1666666666667),
Point(-39.533333333332997,-7.1666666666667),
Point(-38.916666666666998,-7.1666666666667),
Point(-39.216666666667003,-7.1666666666667),
Point(-39.733333333333,-7.1833333333333),
Point(-40.016666666667,-7.1833333333333),
Point(-39.083333333333002,-7.1833333333333),
Point(-40.133333333332999,-7.2),
Point(-40.2,-7.2),
Point(-39.316666666666997,-7.2166666666667),
Point(-39.4,-7.2333333333333),
Point(-39.416666666666998,-7.2333333333333),
Point(-39.133333333332999,-7.25),
Point(-40.466666666667003,-7.2833333333333),
Point(-38.933333333333003,-7.3),
Point(-38.766666666667,-7.3166666666667),
Point(-39.32,-7.3166666666667),
Point(-39.3,-7.3333333333333),
Point(-38.666666666666998,-7.3333333333333),
Point(-39.05,-7.3666666666667),
Point(-38.766666666667,-7.3833333333333),
Point(-39.133333333332999,-7.4),
Point(-39.2,-7.4),
Point(-39.066666666666997,-7.4333333333333),
Point(-38.766666666667,-7.4666666666667),
Point(-38.983333333333,-7.4911111111111),
Point(-38.75,-7.5),
Point(-39.173055555555997,-7.5016666666667),
Point(-39.116666666667001,-7.5333333333333),
Point(-38.833333333333002,-7.5333333333333),
Point(-39.283333333332997,-7.5833333333333),
Point(-39.2,-7.5833333333333),
Point(-39.011111111110999,-7.6775),
Point(-39.0,-7.6833333333333),
Point(-39.066666666666997,-7.8166666666667)};


CanvasWidget::CanvasWidget(QWidget *parent) :
    QGLWidget(QGLFormat(QGL::SampleBuffers|QGL::AlphaChannel), parent)
{
    setMaximumSize(m_max_width, m_max_height);

    m_element_manager.addPointArr(ceara, 559);
    // m_element_manager.addTriangle(5, 5, 0.5);

    m_painter = new Painter(*this, m_element_manager);
}

void CanvasWidget::initializeGL() {
    m_painter->init();
}

void CanvasWidget::resizeGL(int w, int h) {
    setProjection(w, h);
}

void CanvasWidget::paintGL() {
    m_painter->paint();

    setProjection(width(), height());

    glFlush();
}

void CanvasWidget::addArray(Point *arr, int size)
{

}



void CanvasWidget::wheelEvent(QWheelEvent *event) {
    zoomOut(0.5, event->x(), event->y());
}

void CanvasWidget::mouseDoubleClickEvent(QMouseEvent *event) {
    m_camera.reset();

    updateGL();
    update();
}

void CanvasWidget::keyPressEvent(QKeyEvent *event) {
    if (event->key() == Qt::Key_Plus) {
        QPoint mouse_pos = mapFromGlobal(QCursor::pos());
        zoomOut(0.9, mouse_pos.x(), mouse_pos.y());
    }
}

void CanvasWidget::zoomIn(double zoom_factor, double focus_x, double focus_y) {

}

void CanvasWidget::zoomOut(double zoom_factor, double mouse_viewport_x, double mouse_viewport_y) {
    double new_zoom = m_camera.getZoom() + zoom_factor;

    double width_prop = width() / (m_max_width);
    double height_prop = height() / (m_max_height);

    double actual_zoom_width = (m_camera.getWorldWidth() * width_prop) / m_camera.getZoom();
    double new_zoom_width = (m_camera.getWorldWidth() * width_prop) / new_zoom;

    double actual_zoom_height = (m_camera.getWorldHeight() * height_prop) / m_camera.getZoom();
    double new_zoom_height = (m_camera.getWorldHeight() * height_prop) / new_zoom;

    // pontos de origem da camera em coordenadas do mundo
    double camera_x = m_camera.getPosition().first;
    double camera_y = m_camera.getPosition().second;

    double canvas_right = camera_x + actual_zoom_width;
    double canvas_top = camera_y + actual_zoom_height;

    if (!m_camera.setZoom(new_zoom)) {
        return;
    }

    double current_x = camera_x + (actual_zoom_width / width()) * mouse_viewport_x;
    double current_y = camera_y + (actual_zoom_height / height()) * (height() - mouse_viewport_y);

    // calculate a the position of current cursor considering the current camera current position and the new zoom factor
    double current_new_x = camera_x + (new_zoom_width / width()) * mouse_viewport_x;
    double current_new_y = camera_y + ((new_zoom_height) / height()) * (height() - mouse_viewport_y);

    double camera_new_x = camera_x + (current_x - current_new_x);
    double camera_new_y = camera_y + (current_y - current_new_y); //- (current_y - camera_y) / new_zoom;

    //double camera_new_x = camera_x + (current_x - camera_x) / m_camera.getZoom();
   // double camera_new_y = camera_y + (current_y - camera_y) / m_camera.getZoom();

    double canvas_new_right = camera_new_x + new_zoom_width;
    double canvas_new_top = camera_new_y + new_zoom_height;

    qDebug() << "Canvas World Limits: (" << camera_x << ", " << canvas_right << ") (" << camera_y << ", " << canvas_top << ")";
    qDebug() << "Canvas New World Limits: (" << camera_new_x << ", " << canvas_new_right << ") (" << camera_new_y << ", " << canvas_new_top << ")";
    qDebug() << "Current mouse position: " << mouse_viewport_x << "," << mouse_viewport_y;
    qDebug() << "Current world position: " << current_x << "," << current_y;
    qDebug() << "Zoom: " << m_camera.getZoom();

    m_camera.setPosition(camera_new_x, camera_new_y);

    updateGL();
    update();
}

void CanvasWidget::setProjection(int w, int h) {
    glViewport(0, 0, w, h); // screen coordinates

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    // wgs-84 ou UTM
    // definir: w-max e h-max

    // FRUSTRUM
    double width_prop = w / (m_max_width);
    double height_prop = h / (m_max_height);

    double pos_x = m_camera.getPosition().first;
    double pos_y = m_camera.getPosition().second;

    double right = pos_x + (m_camera.getWorldWidth() * width_prop) / m_camera.getZoom();
    double top = pos_y + (m_camera.getWorldHeight() * height_prop) / m_camera.getZoom();

    glOrtho(
                pos_x,
                right,
                pos_y,
                top,
                0.0,
                1.0
            );

    glMatrixMode(GL_MODELVIEW);
}
